# üìä –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ4: –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –∑–∞–ø–∏—Ç–∏ (OLAP)

**–ú–µ—Ç–∞:** –ù–∞–≤—á–∏—Ç–∏—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è, –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å —Ç–∞ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Å–æ—Ü—ñ–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ (Posts, Users, Comments, Followers).

---

## –û–ø–∏—Å –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

### 1. –ê–≥—Ä–µ–≥–∞—Ü—ñ—è —Ç–∞ –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è (–ó–∞–ø–∏—Ç–∏ 1-6)

–¶–µ–π —Ä–æ–∑–¥—ñ–ª –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –±–∞–∑–æ–≤—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

| ‚Ññ | –ó–∞–ø–∏—Ç | –û–ø–∏—Å —Ç–∞ –ê–Ω–∞–ª—ñ–∑ |
| :--- | :--- | :--- |
| **1** | `SELECT COUNT(*) FROM users;` | **–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:** –í–∏–∑–Ω–∞—á–µ–Ω–æ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –±–∞–∑–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏. |
| **2** | `SELECT AVG(likes_count) as avarage_likes from POSTS;` | **–°–µ—Ä–µ–¥–Ω—è –≤–ø–æ–¥–æ–±–∞–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –û–±—á–∏—Å–ª–µ–Ω–æ —Å–µ—Ä–µ–¥–Ω—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–ø–æ–¥–æ–±–∞–Ω—å –Ω–∞ –≤—Å—ñ—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è—Ö. |
| **3** | `SELECT SUM(likes_count) FROM posts;` | **–°—É–º–∞—Ä–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–ø–æ–¥–æ–±–∞–Ω—å:** –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å "–ª–∞–π–∫—ñ–≤", –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö —É—Å—ñ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ. |
| **4** | `SELECT MIN(comments_count), MAX(comments_count) from posts;` | **–î—ñ–∞–ø–∞–∑–æ–Ω –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤:** –í–∏–∑–Ω–∞—á–µ–Ω–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –Ω–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è—Ö, —â–æ –¥–∞—î —É—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ —Ä–æ–∑–º–∞—Ö –¥–∏—Å–∫—É—Å—ñ–π. |
| **5** | `SELECT user_id, COUNT(post_id) as count_posts from posts GROUP BY user_id;` | **–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–ü—É–±–ª—ñ–∫–∞—Ü—ñ—ó):** –ü—ñ–¥—Ä–∞—Ö–æ–≤–∞–Ω–æ, —Å–∫—ñ–ª—å–∫–∏ –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —Å—Ç–≤–æ—Ä–∏–≤ –∫–æ–∂–µ–Ω –æ–∫—Ä–µ–º–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á. |
| **6** | `SELECT u.username, u.country, AVG(p.likes_count) as avarage_likes FROM users u JOIN posts p ON p.user_id = u.user_id GROUP BY u.username, u.country;` | **–°–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ—Å—Ç—ñ–≤ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ `JOIN` —Ç–∞ `GROUP BY` –¥–ª—è –æ—Ü—ñ–Ω–∫–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ "–ø–æ–ø—É–ª—è—Ä–Ω–∏–π" –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–≤–æ—Ä—é—î –∫–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É —Å–µ—Ä–µ–¥–Ω—å–æ–º—É. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.13.31.png)
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.14.04.png)
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.14.47.png)

---

### 2. –û–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å (JOINs) (–ó–∞–ø–∏—Ç–∏ 7, 8, 12, 13)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –æ–±'—î–¥–Ω–∞–Ω—å –¥–ª—è –∑–±–æ—Ä—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –∫—ñ–ª—å–∫–æ—Ö —Ç–∞–±–ª–∏—Ü—å, –º–æ–¥–µ–ª—é—é—á–∏ —Å–∫–ª–∞–¥–Ω—ñ –∑–≤'—è–∑–∫–∏ —Å–æ—Ü—ñ–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.

| ‚Ññ | –ó–∞–ø–∏—Ç | –û–ø–∏—Å —Ç–∞ –ê–Ω–∞–ª—ñ–∑ |
| :--- | :--- | :--- |
| **7** | `SELECT p.post_id, COUNT(c.comment_id) FROM posts p JOIN comments c ON c.post_id = p.post_id GROUP BY p.post_id;` | **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –¥–æ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó (INNER JOIN):** –û–±'—î–¥–Ω–∞–Ω–æ —Ç–∞–±–ª–∏—Ü—ñ **`posts`** —Ç–∞ **`comments`** –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –¥–æ –∫–æ–∂–Ω–æ—ó –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.15.27.png)
| **8** | `SELECT u.username, COUNT(f.following_id) from users u LEFT JOIN followers f ON u.user_id = f.following_id GROUP BY u.username;` | **–ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤ (LEFT JOIN):** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ `LEFT JOIN` –º—ñ–∂ **`users`** —Ç–∞ **`followers`**. –¶–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ **–≤—Å—ñ—Ö** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –≤–∫–ª—é—á–Ω–æ –∑ —Ç–∏–º–∏, —É –∫–æ–≥–æ **0 –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤**. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.16.06.png)
| **12**| `SELECT p.post_id, c.comment_id, u.username FROM posts p INNER JOIN comments c ON c.post_id = p.post_id INNER JOIN users u ON u.user_id = p.user_id`| **–î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ (Multi-JOIN):** –û–±'—î–¥–Ω–∞–Ω–æ —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ñ (**`posts`**, **`comments`**, **`users`**) –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —è–∫—ñ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó, —è–∫—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ —Ç–∞ —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (–∞–≤—Ç–æ—Ä–∏ –ø–æ—Å—Ç—ñ–≤) –ø–æ–≤'—è–∑–∞–Ω—ñ –º—ñ–∂ —Å–æ–±–æ—é. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.17.01.png)
| **13**| `SELECT p.post_id, p.caption, u.username, p.likes_count FROM users u RIGHT JOIN posts p ON u.user_id = p.user_id ORDER BY p.created_at DESC;` | **–ö–æ–Ω—Ç–µ–Ω—Ç —Ç–∞ –π–æ–≥–æ –∞–≤—Ç–æ—Ä–∏ (RIGHT JOIN):** –û–±'—î–¥–Ω—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ —ó—Ö–Ω—ñ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó, –≥–∞—Ä–∞–Ω—Ç—É—é—á–∏, —â–æ –≤—Å—ñ **–ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó** –±—É–¥—É—Ç—å –≤–∫–ª—é—á–µ–Ω—ñ —É —Ä–µ–∑—É–ª—å—Ç–∞—Ç. |

---

### 3. –ê–Ω–∞–ª—ñ–∑ –∑ —É–º–æ–≤–Ω–∏–º –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è–º —Ç–∞ –ü—ñ–¥–∑–∞–ø–∏—Ç–∏ (HAVING, Subqueries) (–ó–∞–ø–∏—Ç–∏ 9-11)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å —Å–∫–ª–∞–¥–Ω—ñ—à—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó, —â–æ –≤–∏–º–∞–≥–∞—é—Ç—å —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø—ñ—Å–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è (`HAVING`) –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —è–∫ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è —ñ–Ω—à–æ–≥–æ (`Subqueries`).

| ‚Ññ | –ó–∞–ø–∏—Ç | –û–ø–∏—Å —Ç–∞ –ê–Ω–∞–ª—ñ–∑ |
| :--- | :--- | :--- |
| **9** | `SELECT u.user_id, COUNT(p.post_id) FROM users u LEFT JOIN posts p ON p.user_id = u.user_id GROUP BY u.user_id HAVING COUNT(p.post_id) > 1;` | **–ê–∫—Ç–∏–≤–Ω—ñ –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–π–∫–µ—Ä–∏ (HAVING):** –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π –∑–∞–ø–∏—Ç –¥–ª—è –ø–æ—à—É–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ —Å—Ç–≤–æ—Ä–∏–ª–∏ **–±—ñ–ª—å—à–µ –æ–¥–Ω—ñ—î—ó –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó**. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.22.28.png)
| **10** | `SELECT p.post_id, p.likes_count FROM posts p GROUP BY p.post_id HAVING p.likes_count > (SELECT AVG(likes_count) FROM posts);` | **"–í—ñ—Ä—É—Å–Ω—ñ" –ø–æ—Å—Ç–∏ (–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —ñ–∑ —Å–µ—Ä–µ–¥–Ω—ñ–º):** –ü—ñ–¥–∑–∞–ø–∏—Ç –æ–±—á–∏—Å–ª—é—î **–≥–ª–æ–±–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–Ω—î** –∑–Ω–∞—á–µ–Ω–Ω—è –≤–ø–æ–¥–æ–±–∞–Ω—å. –û—Å–Ω–æ–≤–Ω–∏–π –∑–∞–ø–∏—Ç –≤–∏–±–∏—Ä–∞—î —Ç—ñ–ª—å–∫–∏ —Ç—ñ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó, —è–∫—ñ **–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ –∑–∞ —Ü–µ —Å–µ—Ä–µ–¥–Ω—î** –∑–Ω–∞—á–µ–Ω–Ω—è. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.23.22.png)
| **11** | `SELECT u.country, SUM (p.likes_count) FROM users u JOIN posts p ON p.user_id = u.user_id GROUP BY u.country HAVING SUM(p.likes_count) > 200;` | **–ù–∞–π–∞–∫—Ç–∏–≤–Ω—ñ—à—ñ –∫—Ä–∞—ó–Ω–∏ (HAVING –∑ –∞–≥—Ä–µ–≥–∞—Ü—ñ—î—é):** –í–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∫—Ä–∞—ó–Ω–∏, —Å—É–º–∞—Ä–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —è–∫–∏—Ö –Ω–∞–±—Ä–∞–≤ **–±—ñ–ª—å—à–µ 200 –≤–ø–æ–¥–æ–±–∞–Ω—å**. |
![image](/lab4/screenshots/Screenshot%202025-12-02%20at%2021.23.54.png)
